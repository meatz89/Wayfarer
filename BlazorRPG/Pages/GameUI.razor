@page "/"
@inherits ComponentBase

<div class="top-bar">
    <div class="time-display">
        @CurrentTime 🌅
    </div>

    <div class="energy-meters">
        <div class="energy-meter">
            <div class="meter-bar">
                <div class="meter-fill physical" style="width: @(physicalEnergyCurrent * 100 / physicalEnergyMax)%"></div>
            </div>
            <span>Physical (@physicalEnergyCurrent/@physicalEnergyMax)</span>
        </div>
        <div class="energy-meter">
            <div class="meter-bar">
                <div class="meter-fill social" style="width: @(socialEnergyCurrent * 100 / socialEnergyMax)%"></div>
            </div>
            <span>Social (@socialEnergyCurrent/@socialEnergyMax)</span>
        </div>
    </div>

    <div class="resources">
        <div class="resource coins">🪙 @coins Coins</div>
        <div class="resource food">🍖 @food Food</div>
        <div class="resource shelter">
            🏠 @(hasShelter ? "Sheltered" : "No Shelter")
        </div>
    </div>
</div>

<div class="game-container">
    <div class="locations-grid">
        @foreach (var location in Locations)
        {
            <div class="location-card @(location.Name == CurrentLocation.Name ? "current" : "reachable")">
                <div class="location-name">
                    @location.Name @(location.Name == CurrentLocation.Name ? "(Current)" : "")
                </div>
                <div class="location-type">@location.CoreType</div>
                <div class="location-time">⏰ @location.TimeWindows</div>

                @if (location.HasBadShelter)
                {
                    <div class="location-warning">⚠️ Bad Shelter</div>
                }

                @if (location.HasShelter)
                {
                    <div class="location-shelter">🏠 Shelter Available (@location.ShelterCost 🪙)</div>
                }

                @if (location.Name == CurrentLocation.Name)
                {
                    @foreach (var action in location.AvailableActions)
                    {
                        <button class="action-button"
                                onclick="executeAction('@action.Id')"
                                disabled="@(!action.IsAvailable)">
                            @action.Name (@action.Cost)
                        </button>
                    }
                }
                else
                {
                    <button class="action-button"
                            onclick="travel('@location.Name')"
                            disabled="@(!CanTravelTo(location.Name))">
                        TRAVEL HERE
                    </button>
                }
            </div>
        }
    </div>

    <div class="sidebar">
        <div class="sidebar-panel current-location">
            <div class="panel-title">Current Location</div>
            <div class="panel-content">
                <div>@CurrentLocation</div>
                <div>Available Actions:</div>
                @foreach (var action in CurrentLocation.AvailableActions)
                {
                    <div>• @action.Name (@action.Cost)</div>
                }
            </div>
        </div>

        <div class="sidebar-panel">
            <div class="panel-title">Daily Requirements</div>
            <div class="panel-content">
                <div class="requirement">
                    <span style="color: var(--resource-food)">• 1 Food by Night</span>
                </div>
                <div class="requirement">
                    <span style="color: var(--resource-shelter)">• Shelter during Night</span>
                </div>
            </div>
        </div>

        <div class="sidebar-panel">
            <div class="panel-title">Time Management</div>
            <div class="panel-content">
                <div>• Travel takes time</div>
                <div>• Actions advance time</div>
                <div>• Plan your day carefully</div>
            </div>
        </div>
    </div>
</div>