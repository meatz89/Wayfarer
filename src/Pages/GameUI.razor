@page "/"

@inherits GameUIBase

@namespace Wayfarer.Pages

@{
    Console.WriteLine($"[GameUI.razor] Starting render...");
    try {
        Console.WriteLine($"[GameUI.razor] ContentValidator null? {ContentValidator == null}");
        Console.WriteLine($"[GameUI.razor] GameWorld null? {GameWorld == null}");
        Console.WriteLine($"[GameUI.razor] CurrentView: {CurrentView}");
    } catch (Exception ex) {
        Console.WriteLine($"[GameUI.razor] ERROR accessing services: {ex.Message}");
    }
}

<div class="game-container">
    <h1>TEST: GameUI is rendering!</h1>
    <p>CurrentView: @CurrentView</p>
    
    @if (CurrentView == CurrentViews.MissingReferences)
    {
        <MissingReferences OnMissingReferencesResolved="ResolvedMissingReferences" />
    }
    else if (CurrentView == CurrentViews.CharacterScreen)
    {
        <CharacterCreation OnCharacterCreated="HandleCharacterCreated" />
    }
    else
    {
        <MainGameplayView CurrentView="@CurrentView" OnNavigate="@NavigateTo" />
    }
    <MusicSelector />
    <MusicPlayer />
</div>

@if (LoadingStateService != null)
{
    <LoadingIndicator IsVisible="@LoadingStateService.IsLoading"
                      Message="@LoadingStateService.Message"
                      ShowProgress="true"
                      Progress="@LoadingStateService.Progress" />
}
