@using Wayfarer.Pages.Components
@inherits GameScreenBase

@namespace Wayfarer.Pages

<div class="game-container">
    <!-- Player Resources Bar (from mockup) -->
    <div class="resources-bar">
        <div class="resource-group">
            <div class="resource @(Coins < 5 ? "low" : "")">
                <div class="resource-icon">üí∞</div>
                <div class="resource-value">@Coins</div>
                <span>Coins</span>
            </div>
            <div class="resource @(Health < 30 ? "low" : "")">
                <div class="resource-icon">‚ù§Ô∏è</div>
                <div class="resource-value">@Health</div>
                <span>Health</span>
            </div>
            <div class="resource @(Food > 60 ? "low" : "")">
                <div class="resource-icon">üçû</div>
                <div class="resource-value">@Food</div>
                <span>Hunger</span>
            </div>
            <div class="resource">
                <div class="resource-icon">üëÅÔ∏è</div>
                <div class="resource-value">@Attention/@MaxAttention</div>
                <span>Attention</span>
            </div>
        </div>
        <div class="resource-group">
            <div class="resource">
                <span>@TimePeriod</span>
            </div>
        </div>
    </div>
    
    <!-- Time and Location Header (from mockup) -->
    <div class="header">
        <div class="time-bar">
            <span class="current-time">@CurrentTime</span>
            @if (!string.IsNullOrEmpty(MostUrgentDeadline))
            {
                <span class="deadline-warning">‚ö† @MostUrgentDeadline</span>
            }
        </div>
    </div>

    <!-- Dynamic Content Area -->
    <CascadingValue Value="@this">
        <div @key="@($"{CurrentScreen}_{ContentVersion}")">
            @switch (CurrentScreen)
            {
                case ScreenMode.Location:
                    <LocationContent OnActionExecuted="RefreshUI" />
                    break;
                    
                case ScreenMode.Conversation:
                    <ConversationContent Context="@CurrentConversationContext" OnConversationEnd="HandleConversationEnd" />
                    break;
                    
                case ScreenMode.ObligationQueue:
                    <ObligationQueueContent OnNavigate="HandleNavigation" ReturnView="@PreviousScreen" />
                    break;
                    
                case ScreenMode.Travel:
                    <TravelContent 
                        CurrentLocation="@GetCurrentLocation()"
                        OnTravelRoute="HandleTravelRoute"
                        OnNavigate="HandleNavigation" />
                    break;
                    
                case ScreenMode.DeckViewer:
                    <NPCDeckViewer />
                    break;
                    
                default:
                    <LocationContent OnActionExecuted="RefreshUI" />
                    break;
            }
        </div>
    </CascadingValue>
    
    <!-- Toast Notifications -->
    <MessageDisplay />
</div>