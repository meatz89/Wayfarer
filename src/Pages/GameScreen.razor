@using Wayfarer.Pages.Components
@inherits GameScreenBase

@namespace Wayfarer.Pages

<div class="game-container">
    <!-- Player Resources Bar (from mockup) -->
    <div class="resources-bar">
        <div class="resource-group">
            <div class="resource @(Coins < 5 ? "low" : "")">
                <div class="resource-icon">üí∞</div>
                <div class="resource-value">@Coins</div>
                <span>Coins</span>
            </div>
            <div class="resource @(Health < 30 ? "low" : "")">
                <div class="resource-icon">‚ù§Ô∏è</div>
                <div class="resource-value">@Health</div>
                <span>Health</span>
            </div>
            <div class="resource @(Hunger > 60 ? "low" : "")">
                <div class="resource-icon">üçû</div>
                <div class="resource-value">@Hunger</div>
                <span>Hunger</span>
            </div>
            <div class="resource">
                <div class="resource-icon">üëÅÔ∏è</div>
                <div class="resource-value">@Attention/@MaxAttention</div>
                <span>Attention</span>
            </div>
        </div>
        <div class="resource-group">
            <div class="resource">
                <span>@CurrentTime ‚Ä¢ @TimePeriod</span>
            </div>
        </div>
    </div>

    <!-- Dynamic Content Area -->
    <CascadingValue Value="@this">
        <div @key="@($"{CurrentScreen}_{ContentVersion}")">
            @{
                Console.WriteLine($"[GameScreen.razor] Rendering with CurrentScreen={CurrentScreen}, ContentVersion={ContentVersion}");
            }
            @switch (CurrentScreen)
            {
                case ScreenMode.Location:
                    <LocationContent OnActionExecuted="RefreshUI" />
                    break;
                    
                case ScreenMode.Conversation:
                    <ConversationContent Context="@CurrentConversationContext" OnConversationEnd="HandleConversationEnd" />
                    break;
                    
                case ScreenMode.Exchange:
                    <ExchangeContent Context="@CurrentExchangeContext" OnExchangeEnd="HandleExchangeEnd" />
                    break;
                    
                case ScreenMode.ObligationQueue:
                    <ObligationQueueContent OnNavigate="HandleNavigation" ReturnView="@PreviousScreen" />
                    break;
                    
                case ScreenMode.Travel:
                    <TravelContent 
                        CurrentLocation="@GetCurrentLocation()"
                        OnTravelRoute="HandleTravelRoute"
                        OnNavigate="HandleNavigation" />
                    break;
                    
                case ScreenMode.DeckViewer:
                    <NPCDeckViewer />
                    break;
                    
                default:
                    <LocationContent OnActionExecuted="RefreshUI" />
                    break;
            }
        </div>
    </CascadingValue>
    
    <!-- Toast Notifications -->
    <MessageDisplay />
</div>