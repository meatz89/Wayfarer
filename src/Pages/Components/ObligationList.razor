@namespace Wayfarer.Pages.Components
@inject GameWorld GameWorld
@*
Obligation List - Displays all active obligations (NPC-commissioned and self-discovered)
Shows deadlines, rewards, and progress
*@

<div class="obligation-list">
    <h3 class="obligation-list-header">Active Obligations</h3>

    @if (ActiveObligations == null || !ActiveObligations.Any())
    {
        <p class="no-obligations">No active obligations</p>
    }
    else
    {
        <div class="obligation-cards">
            @foreach (Obligation obligation in ActiveObligations)
            {
                <ObligationCard Obligation="@obligation" CurrentSegment="@CurrentSegment" />
            }
        </div>
    }
</div>

@code {
    [Parameter] public int CurrentSegment { get; set; }

    private List<Obligation> ActiveObligations { get; set; }

    protected override void OnInitialized()
    {
        LoadActiveObligations();
    }

    protected override void OnParametersSet()
    {
        LoadActiveObligations();
    }

    private void LoadActiveObligations()
    {
        ActiveObligations = GameWorld.GetActiveObligations();
    }
}
