@namespace Wayfarer.Pages.Components

@inject ScenarioManager ScenarioManager
@inject NavigationService NavigationService
@inject MessageSystem MessageSystem

<div class="scenario-selector">
    @if (ScenarioManager.IsScenarioActive())
    {
        <div class="active-scenario">
            <h3>üìú Active Scenario</h3>
            <p>@ScenarioManager.GetScenarioStatus()</p>
            <button class="btn btn-danger" @onclick="EndScenario">End Scenario</button>
        </div>
    }
    else
    {
        <div class="scenario-list">
            <h3>üéÆ Challenge Scenarios</h3>
            <div class="scenario-card">
                <h4>14-Day Challenge</h4>
                <p>Master the Queue - Survive 14 Days</p>
                <div class="scenario-details">
                    <p>üìç Starting location: Millbrook</p>
                    <p>üí∞ Starting money: 12 coins</p>
                    <p>üì¨ Starting with 3 letters in queue</p>
                    <p>üéØ Goal: Maintain 3+ positive relationships AND deliver patron's final letter</p>
                </div>
                <button class="btn btn-primary" @onclick="@(() => StartScenario("14_day_challenge"))">
                    Start Challenge
                </button>
            </div>
            
            @* Future scenarios can be added here *@
            <div class="scenario-card disabled">
                <h4>The Patron's Game</h4>
                <p>Coming soon - Uncover your patron's true identity</p>
                <button class="btn btn-secondary" disabled>Not Available</button>
            </div>
            
            <div class="scenario-card disabled">
                <h4>Carrier Network Crisis</h4>
                <p>Coming soon - Navigate conflicting patron demands</p>
                <button class="btn btn-secondary" disabled>Not Available</button>
            </div>
        </div>
    }
</div>

@code {
    private void StartScenario(string scenarioId)
    {
        ScenarioManager.StartScenario(scenarioId);
        NavigationService.NavigateTo(CurrentViews.LocationScreen);
    }
    
    private void EndScenario()
    {
        if (ScenarioManager.IsScenarioActive())
        {
            ScenarioManager.EndScenario();
            StateHasChanged();
        }
    }
}

<style>
    .scenario-selector {
        padding: 20px;
        max-width: 800px;
        margin: 0 auto;
    }
    
    .active-scenario {
        background: #2a2a2a;
        border: 2px solid #4a4a4a;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
    }
    
    .active-scenario h3 {
        color: #f0ad4e;
        margin-bottom: 10px;
    }
    
    .scenario-list h3 {
        color: #5cb85c;
        margin-bottom: 20px;
        text-align: center;
    }
    
    .scenario-card {
        background: #2a2a2a;
        border: 1px solid #4a4a4a;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        transition: all 0.3s ease;
    }
    
    .scenario-card:hover:not(.disabled) {
        border-color: #5cb85c;
        box-shadow: 0 0 10px rgba(92, 184, 92, 0.3);
    }
    
    .scenario-card.disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }
    
    .scenario-card h4 {
        color: #fff;
        margin-bottom: 10px;
    }
    
    .scenario-card p {
        color: #999;
        margin-bottom: 15px;
    }
    
    .scenario-details {
        background: #1a1a1a;
        border-radius: 4px;
        padding: 15px;
        margin-bottom: 15px;
        font-size: 0.9em;
    }
    
    .scenario-details p {
        margin: 5px 0;
        color: #ccc;
    }
    
    .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
    }
    
    .btn-primary {
        background: #5cb85c;
        color: white;
    }
    
    .btn-primary:hover {
        background: #4cae4c;
    }
    
    .btn-danger {
        background: #d9534f;
        color: white;
    }
    
    .btn-danger:hover {
        background: #c9302c;
    }
    
    .btn-secondary {
        background: #6c757d;
        color: white;
    }
    
    .btn-secondary:disabled {
        cursor: not-allowed;
        opacity: 0.5;
    }
</style>