@namespace Wayfarer.Pages.Components.SpawnGraph
@using Wayfarer.Pages.Components

<div class="spawn-node scene-node @GetStateClass() @GetSelectedClass() @GetHighlightedClass()" @ondblclick="OnDoubleClick" @ondblclick:stopPropagation>
    <div class="node-header">
        <Icon Name="drama-masks" Size="14px" CssClass="node-icon" />
        <div class="node-badge">Scene</div>
    </div>
    <div class="node-label">@Node.DisplayName</div>
    <div class="node-info">
        @Node.Category
        @if (Node.SituationCount > 0)
        {
            <span> | @Node.SituationCount situations</span>
        }
    </div>
</div>

@code {
    [Parameter] public SceneNodeModel Node { get; set; }

    private void OnDoubleClick()
    {
        Node.TriggerDoubleClick();
    }

    private string GetStateClass()
    {
        return Node.CurrentState switch
        {
            SceneState.Active => "state-active",
            SceneState.Completed => "state-completed",
            SceneState.Deferred => "state-deferred",
            _ => ""
        };
    }

    private string GetSelectedClass()
    {
        return Node.Selected ? "selected" : "";
    }

    private string GetHighlightedClass()
    {
        return Node.IsHighlighted ? "highlighted" : "";
    }
}
