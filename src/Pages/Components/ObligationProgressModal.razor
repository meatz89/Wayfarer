@inherits ObligationProgressModalBase
@namespace Wayfarer.Pages.Components

<div class="obligation-notification-container">
    <div class="obligation-header">
        <div class="obligation-icon">üîç</div>
        <div class="obligation-title-section">
            <div class="obligation-main-title">Obligation Progress</div>
            <div class="obligation-subtitle">@Data.ObligationName</div>
        </div>
    </div>

    <div class="obligation-outcome-section">
        <div class="outcome-text">@Data.OutcomeNarrative</div>

        <div class="situation-completed-box">
            <div class="completed-label">Situation Completed</div>
            <div class="completed-situation-name">@Data.CompletedSituationName</div>
        </div>
    </div>

    @if (Data.NewLeads != null && Data.NewLeads.Count > 0)
    {
        <div class="new-leads-section">
            <div class="new-leads-header">
                <div class="new-leads-icon">‚ú®</div>
                <div class="new-leads-title">New Leads Discovered</div>
            </div>

            <div class="leads-list">
                @foreach (NewLeadInfo lead in Data.NewLeads)
                {
                    <div class="lead-item">
                        <div class="lead-marker"></div>
                        <div class="lead-content">
                            <div class="lead-text">@lead.SituationName</div>
                            <div class="lead-location">Available at: @lead.LocationName - @lead.SpotName</div>
                        </div>
                    </div>
                }
            </div>
        </div>
    }

    <div class="obligation-progress-section">
        <div class="progress-label">Obligation Progress: @Data.ObligationName</div>
        <div class="progress-bar">
            <div class="progress-fill" style="width: @GetProgressPercent()%"></div>
        </div>
        <div class="progress-text">@Data.CompletedSituationCount of @Data.TotalSituationCount situations completed</div>
    </div>

    <div class="action-section">
        <button class="continue-button" @onclick="CloseModal">Continue Obligation</button>
    </div>
</div>
