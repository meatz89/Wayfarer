/* ===== CARD ANIMATION SYSTEM ===== */
/* SYNCHRONOUS PRINCIPLE: All animations are purely visual feedback.
   They run independently of game logic and NEVER block or delay game state.
   Game effects apply immediately, animations provide visual clarity only.
   CSS timing (0.25s, 0.5s, 1.25s) is for visual polish, not game mechanics. */
/* Visual feedback for card state changes in conversations */

/* === KEYFRAME ANIMATIONS === */

/* Draw animation - cards enter from LEFT (from deck) */
@keyframes card-draw-left {
    0% {
        opacity: 0;
        transform: translateX(-300px) scale(0.3) rotateY(30deg);
    }
    40% {
        opacity: 0.5;
        transform: translateX(-150px) scale(0.6) rotateY(15deg);
    }
    70% {
        opacity: 0.9;
        transform: translateX(-50px) scale(0.9) rotateY(5deg);
    }
    100% {
        opacity: 1;
        transform: translateX(0) scale(1) rotateY(0);
    }
}

/* Exhaust animation - cards exit to RIGHT (to discard) */
@keyframes card-exhaust-right {
    0% {
        opacity: 1;
        transform: translateX(0) scale(1);
        filter: grayscale(0);
    }
    30% {
        opacity: 0.8;
        transform: translateX(50px) scale(0.95) rotateY(-10deg);
        filter: grayscale(0.3) sepia(0.3);
    }
    60% {
        opacity: 0.5;
        transform: translateX(150px) scale(0.8) rotateY(-20deg);
        filter: grayscale(0.6) sepia(0.6);
    }
    100% {
        opacity: 0;
        transform: translateX(300px) scale(0.3) rotateY(-30deg);
        filter: grayscale(1) sepia(1);
        max-height: 0;
        margin: 0;
        padding: 0;
    }
}

/* Success flash - green highlight */
@keyframes card-success-flash {
    0% {
        background-color: #faf4ea;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    30% {
        background-color: #e8f5e8; /* Subtle warm green tint */
        box-shadow: 0 2px 12px rgba(100,200,100,0.3);
    }
    90% {
        background-color: #e8f5e8; /* Hold the color */
        box-shadow: 0 2px 12px rgba(100,200,100,0.2);
    }
    100% {
        background-color: #e8f5e8;
        box-shadow: 0 2px 8px rgba(100,200,100,0.15);
    }
}

/* Failure flash - subtle gray-red tint with downward drift */
@keyframes card-failure-flash {
    0% {
        background-color: #faf4ea;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    20% {
        background-color: #f0e8e8; /* Subtle cool gray-red tint */
        box-shadow: 0 2px 12px rgba(150,100,100,0.3);
    }
    40% {
    }
    90% {
        background-color: #e8e8f0; /* Cool gray tint */
        box-shadow: 0 2px 8px rgba(100,100,150,0.2);
    }
    100% {
        background-color: #e8e8f0;
        box-shadow: 0 1px 4px rgba(100,100,150,0.15);
    }
}


/* Transition out for played cards */
@keyframes card-play-out {
    0% {
        transform: translateY(0) scale(1);
        opacity: 1;
    }
    100% {
        transform: translateY(-100px) scale(0.5);
        opacity: 0;
    }
}

/* === CARD STATE CLASSES === */

/* Newly drawn cards - enter from left */
.card-new {
    animation: card-draw-left 0.5s ease-out;
    animation-fill-mode: both;
}

/* Staggered animation delays for multiple cards */
.card-new:nth-child(1) { animation-delay: 0.0s; }
.card-new:nth-child(2) { animation-delay: 0.15s; }
.card-new:nth-child(3) { animation-delay: 0.30s; }
.card-new:nth-child(4) { animation-delay: 0.45s; }
.card-new:nth-child(5) { animation-delay: 0.60s; }
.card-new:nth-child(6) { animation-delay: 0.75s; }

/* Alternative: Use CSS custom properties for dynamic delays (set by JavaScript) */
.card-new.staggered {
    animation-delay: var(--stagger-delay, 0s);
}

/* Successfully played card - longer, clearer animation */
.card-played-success {
    animation: card-success-flash 1.25s ease-out, card-play-out 0.25s ease-out 1.25s;
    animation-fill-mode: forwards;
    pointer-events: none;
}

/* Failed played card - longer, clearer animation */
.card-played-failure {
    animation: card-failure-flash 1.25s ease-out, card-play-out 0.25s ease-out 1.25s;
    animation-fill-mode: forwards;
    pointer-events: none;
}

/* Exhausting cards - exit to right */
.card-exhausting {
    animation: card-exhaust-right 0.5s ease-out;
    animation-fill-mode: forwards;
    pointer-events: none;
    position: relative;
    overflow: hidden;
}

/* Visual indicator for cards about to exhaust */
.card-will-exhaust {
    position: relative;
    overflow: visible;
}

.card-will-exhaust::before {
    content: 'Will Exhaust';
    position: absolute;
    top: -25px;
    left: 50%;
    transform: translateX(-50%);
    background: #ff6b6b;
    color: white;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 0.75rem;
    font-focus: bold;
    z-index: 10;
}

/* === TRANSITION HELPERS === */

/* Smooth transitions for card hover states */
.card {
    transition: transform 0.1s ease, box-shadow 0.1s ease;
}

.card:not(.card-played-success):not(.card-played-failure):not(.card-exhausting):hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.15);
}

/* Disable hover for animating cards */
.card-new,
.card-played-success,
.card-played-failure,
.card-exhausting {
    pointer-events: none;
}

/* Re-enable pointer events after new card animation */
.card-new {
    animation: card-slide-in 0.25s ease-out;
    animation-fill-mode: both;
    pointer-events: none;
}

.card-new.animation-complete {
    pointer-events: auto;
    animation: none;
}

/* === VISUAL FEEDBACK BADGES === */

/* Badge for impulse cards */
.card-impulse-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    background: #ff9800;
    color: white;
    padding: 2px 6px;
    border-radius: 12px;
    font-size: 0.7rem;
    font-focus: bold;
}

/* Badge for opening cards */
.card-opening-badge {
    position: absolute;
    top: 10px;
    left: 10px;
    background: #2196F3;
    color: white;
    padding: 2px 6px;
    border-radius: 12px;
    font-size: 0.7rem;
    font-focus: bold;
}

/* === HAND CONTAINER ADJUSTMENTS === */

/* Ensure hand container allows for animations */
.hand-container {
    position: relative;
    overflow: visible;
    padding: 20px 10px;
    min-height: 200px;
}

/* Grid layout for cards with animation space */
.card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 15px;
    padding: 10px;
}

/* === DEBUG HELPERS === */

/* Visual state indicators for development */
.debug-mode .card::after {
    content: attr(data-state);
    position: absolute;
    bottom: 5px;
    right: 5px;
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 2px 5px;
    font-size: 0.6rem;
    border-radius: 3px;
}