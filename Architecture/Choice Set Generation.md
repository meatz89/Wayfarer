**A System of Interlocking Parts: Locations, Actions, Encounters, and Choices**

This game is built on a foundation of interconnected systems designed to create elegant, deterministic encounters that offer meaningful choices to the player. The core loop revolves around exploring **Locations**, engaging in **Actions**, and navigating the resulting **Encounters** through a series of carefully crafted **Choices**.

**1. Locations: The Foundation of Gameplay**

Locations are not just scenic backdrops but are defined by a set of mechanical properties represented as enums:

*   **LocationArchetype:** (e.g., Tavern, Market, Library, Docks, Workshop) - Dictates the general nature of the location.
*   **CrowdLevel:** (e.g., Empty, Busy, Crowded) - Represents the density of people.
*   **LocationScale:** (e.g., Small, Medium, Large) - Indicates the physical size of the location.

These properties are crucial in determining the available actions and the types of encounters that can occur. The narrative content of locations like their names and descriptions is generated by AI and does not influence the mechanics.

**2. Actions: Initiating Encounters**

Each **Location Spot** within a Location offers a set of **Basic Actions** determined by its properties. Examples include:

*   **Labor:** (e.g., Load Cargo, Serve Drinks, Craft Item)
*   **Investigate:** (e.g., Gather Information, Search for Clues, Analyze Evidence)
*   **Discuss:** (e.g., Negotiate, Persuade, Learn)
*   **Mingle:** (e.g., Build Reputation, Gather Rumors, Make Connections)

When a player selects a Basic Action, an **Encounter** is initiated.

**3. Encounters: Dynamic and Deterministic**

Encounters are multi-stage events driven by an **Encounter Context** that tracks four key narrative values:

*   **Outcome:** (0-10) - Progress towards success.
*   **Pressure:** (0-10) - Mounting tension or difficulty.
*   **Insight:** (0-10) - Player's understanding of the situation.
*   **Resonance:** (0-10) - Player's social standing or influence within the encounter.

These values are integers and are initially set based on the chosen action, location properties, and player state.

**4. Encounter Stages: A Cycle of Choice and Consequence**

Each encounter unfolds in stages, each following a deterministic process:

    **a. Context Assessment:** The system evaluates:
        *   **Location Properties**
        *   **Encounter Context** (Outcome, Pressure, Insight, Resonance)
        *   **Player State** (Energy Levels, Skills, Reputation, Items, Knowledge)

    **b. Choice Set Selection:** The system deterministically selects the most appropriate **Choice Set Template** from a predefined pool based on the current context. Each choice set is designed to offer varied approaches to the situation and, crucially, to modify the encounter context in such a way that each subsequent stage will necessitate a *different* choice set.

    **c. Choice Set Instantiation:** The selected template is customized based on the context:
        *   **Energy Costs** are adjusted.
        *   **Rewards** are tailored.
        *   **Encounter Value Changes** are fine-tuned.

    **d. Choice Presentation:** The player is presented with 3-4 choices, each defined by:
        *   **Choice Archetype:** (Physical, Focus, Social) - Determines the energy type consumed, possible requirements, and potential rewards/costs.
            *   **Physical:** Often increases Outcome, may increase Pressure. Rewards: Coins, Reputation. Costs: Health.
            *   **Focus:** Often increases Insight, may reduce Pressure. Rewards: Knowledge, Items. Costs: Stress.
            *   **Social:** Often increases Resonance, may impact Outcome. Rewards: Relations, Skills. Costs: Reputation.
        *   **Approach:** (Aggressive, Careful, Strategic, Desperate) - Defines the strategic style and dictates which encounter values are affected.
            *   **Aggressive:** High risk/reward, large Outcome gains, increases Pressure.
            *   **Careful:** Balanced, moderate Outcome gains, reduces Pressure.
            *   **Strategic:** Long-term focus, small/no immediate Outcome gain, increases Insight or Resonance.
            *   **Desperate:** Fallback, small Outcome gain, high Pressure cost.
        *   **Energy Cost:** The amount of Physical, Focus, or Social energy required.
        *   **Encounter Value Changes:** How the choice modifies Outcome, Pressure, Insight, and Resonance.
        *   **Requirements:** (Optional) Skill, Item, Knowledge, or Reputation thresholds.
        *   **Rewards:** (Optional) Items, Knowledge, Reputation, or other benefits.
 *   **Basic vs Strategic vs Special:** Each choice set will contain 1-2 Basic choices, 0-1 Strategic choices and 0-1 Special choices, adding another layer of strategic depth.

    **e. Player Choice and Consequence:**
        *   The player selects a choice.
        *   Energy is expended.
        *   Rewards are granted.
        *   Encounter context values are updated.

    **f. Loop or End:**
        *   If the encounter hasn't reached a success or failure state, the process repeats from Step 4a, using the updated context to select a new choice set.
        *   If the encounter has ended, the player experiences the consequences.

**Key Design Goals and Their Implementation:**

*   **Deterministic Outcomes:** The same context will always produce the same choices, ensuring predictability and allowing players to learn the system's mechanics.
*   **3-4 Choices per Stage:** Maintains a manageable decision space while offering meaningful options.
*   **Elegant Rather than Complex:** The system is built on a few core mechanics that interact in sophisticated ways, avoiding unnecessary complexity.
*   **Strong Verisimilitude:** Location properties, action types, and choice consequences are designed to feel logically consistent with the game world.
*   **Choices Reflect Mounting Pressure and Strain:** The Pressure value and the availability of energy resources create a sense of urgency and force players to make difficult decisions.
*   **Clear Impact of Player's Insight and Social Standing:** Insight and Resonance values directly influence the available choices and their effectiveness, emphasizing the importance of knowledge and social connections.

**5. Choice Set Generation: A Deeper Dive**

The process of generating choices deserves further elaboration:

1.  **Player Movement:** The player navigates to a specific Location Spot.
2.  **Action Selection:** The player chooses an available Basic Action, initiating an Encounter.
3.  **Encounter Initiation:** The Encounter begins, with initial Encounter Context values determined by the action, location, and player state.
4.  **Stage Generation (Repeated for each stage):**

    *   **Context Assessment:** The system thoroughly analyzes the Location Properties, Encounter Context, and Player State.
    *   **Choice Set Selection:** Based on this assessment, the system selects the most fitting Choice Set Template. This selection is deterministic â€“ identical contexts will yield identical choice sets. Each choice set is meticulously designed to ensure that the choices within it will modify the Encounter Context in a way that necessitates the selection of a *different* choice set in the subsequent stage.
    *   **Choice Set Instantiation:** The chosen template is then instantiated, becoming a concrete set of choices. This involves:
        *   **Energy Cost Adjustment:** Modifying the energy costs based on player stats or location properties.
        *   **Reward Tailoring:** Customizing rewards to the specific situation (e.g., awarding specific Knowledge or Item rewards).
        *   **Encounter Value Fine-tuning:** Adjusting the precise impact of choices on Outcome, Pressure, Insight, and Resonance.
    *   **Choice Presentation:** The player is presented with 3-4 choices, each fully defined by its Archetype, Approach, Energy Cost, Encounter Value Changes, Requirements (if any), and Rewards (if any).

5.  **Player Choice and Consequence:** The player makes their choice, leading to:

    *   Deduction of associated Energy Costs.
    *   Granting of any earned Rewards.
    *   Updating of Encounter Context Values based on the chosen action.

6.  **Loop or Encounter End:**

    *   If the Encounter hasn't reached a success or failure state, the process returns to Step 4 (Stage Generation) for the next stage. The modified context will result in a different choice set being selected, ensuring variety.
    *   If the Encounter has reached a conclusive state, it ends, and the player faces the consequences of their choices.

**Implications for Choice Set Design:**

*   **Diversity is Paramount:** A large and varied pool of Choice Set Templates is needed to ensure a wide range of experiences across different location/context combinations. This also includes multiple encounters at the same location using the same action type but with different starting and evolving contexts.
*   **Context Sensitivity:** Templates must be designed with specific requirements regarding Location Properties, Encounter Context, and Player State to ensure they are selected appropriately.
*   **Dynamic Adjustment:** The instantiation process must be flexible enough to adjust costs, rewards, and value changes effectively based on the specific circumstances of each encounter.

**Example: Choice Set Selection in Action**

Let's revisit the **INVESTIGATE** action at a **MARKET (Busy, Large)**:

*   **Initial Encounter Context:**
    *   Outcome: 2
    *   Pressure: 3
    *   Insight: 1
    *   Resonance: 2

The system might select a choice set template like "Market Investigation - Initial Lead" because it aligns with the action type, location properties, and the low initial Insight value.

**Stage 1 Choices (Illustrative):**

*   "Question Merchant" (Social - Careful, Basic): Costs 2 Social, increases Insight by +1, decreases Pressure -1, requires Reputation 5, Reward: Gives Clue
*   "Observe Crowd" (Focus - Careful, Basic): Costs 2 Focus, increases Insight by +2, decreases Pressure -1
*   "Inspect Stalls" (Physical - Desperate, Basic): Costs 3 Physical, increases Insight by +1, increases Pressure +2

If the player chooses "Observe Crowd," the context changes:

*   **Updated Encounter Context:**
    *   Outcome: 2
    *   Pressure: 2
    *   Insight: 3
    *   Resonance: 2
    *   Focus Energy: -2

For Stage 2, the system would select a *different* choice set, perhaps "Market Investigation - Following Up," due to the increased Insight, the reduced Focus Energy, and the still-relevant location and action type.

**Conclusion**

This system, with its intricate interplay of Locations, Actions, Encounters, and Choices, creates a dynamic and engaging gameplay experience. It's deterministic, ensuring predictability and allowing players to master its mechanics, yet it feels dynamic and responsive due to the variety of choice sets and the context-sensitive instantiation. The player's choices have a tangible impact on the unfolding narrative, creating a sense of agency within a structured and elegant framework. The AI's role in generating narrative content further enhances the immersive quality of the game, making each playthrough a unique and compelling experience. This system, by achieving a balance between determinism, dynamism, and player agency, delivers on its core design goals of elegance, verisimilitude, and meaningful choice.
